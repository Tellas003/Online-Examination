{% extends 'exam/adminbase.html' %}
{% load widget_tweaks %}
{% block content %}
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

  <style>
    a:link {
      text-decoration: none;
    }
    .hidden {
      display: none;
    }
  </style>
</head>

<h2 style="text-align:center;">Add Question</h2>

<div class="container" style="margin-top:30px;">
  <div class="form-group">
    <label>Select Method:</label>
    <select id="questionMethod" class="form-control" style="width:50%;">
      <option value="">-- Select --</option>
      <option value="manual">Add Manually</option>
      <option value="upload">Upload File</option>
    </select>
  </div>

  <!-- Manual form -->
  <form method="POST" id="manualForm" class="hidden" autocomplete="off" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="form-group">
      <label>Course</label>
      {% render_field questionForm.courseID|attr:'required:true' class="form-control" %}
      <br>
      <label>Question</label>
      {% render_field questionForm.question class="form-control" placeholder="Enter question text" %}
      <br>
      <label>Marks</label>
      {% render_field questionForm.marks class="form-control" placeholder="Example: 5" %}
      <br>
      <label>Option 1</label>
      {% render_field questionForm.option1 class="form-control" %}
      <br>
      <label>Option 2</label>
      {% render_field questionForm.option2 class="form-control" %}
      <br>
      <label>Option 3</label>
      {% render_field questionForm.option3 class="form-control" %}
      <br>
      <label>Option 4</label>
      {% render_field questionForm.option4 class="form-control" %}
      <br>
      <label>Correct Answer</label>
      {% render_field questionForm.answer class="form-control" %}
      <br>
    </div>
    <button type="submit" class="btn btn-success">Submit Question</button>
  </form>

  <!-- Upload form -->
  <form method="POST" id="uploadForm" class="hidden" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="form-group">
      <label>Course</label>
      {% render_field questionForm.courseID|attr:'required:true' class="form-control" %}
      <br>
      <label>Upload Question File (PDF, DOC, XLS, PPT)</label>
      {% render_field questionForm.question_file class="form-control" %}
    </div>
    <button type="submit" class="btn btn-primary">Upload File</button>
  </form>
</div>

<script>
  const methodSelect = document.getElementById("questionMethod");
  const manualForm = document.getElementById("manualForm");
  const uploadForm = document.getElementById("uploadForm");

  methodSelect.addEventListener("change", function () {
    if (this.value === "manual") {
      manualForm.classList.remove("hidden");
      uploadForm.classList.add("hidden");
    } else if (this.value === "upload") {
      uploadForm.classList.remove("hidden");
      manualForm.classList.add("hidden");
    } else {
      manualForm.classList.add("hidden");
      uploadForm.classList.add("hidden");
    }
  });
</script>
{% endblock content %}
